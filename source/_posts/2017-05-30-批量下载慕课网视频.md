---
title: 批量下载慕课网视频
date: 2017-05-30 10:16:29
categories: Tools
---

本文主要是记录如何通过 脚本和工具批量下载 [慕课网视频](http://www.imooc.com/) 方法，当然其它方法也很多，本文只是其中的一种

## 一、使用的工具
### 1. IDM (Internet Download Manager)
> Internet Download Manager（简称“IDM”）是一种将下载速度提高5倍的工具，可以恢复和安排下载。由于连接丢失，网络问题，计算机关机或意外停电等原因，全面的错误恢复和恢复功能将重新启动中断或中断的下载。简单的图形用户界面使IDM用户友好和易于使用.Internet下载管理器具有智能下载逻辑加速器，具有智能动态文件分割和安全的多部分下载技术，以加速您的下载。与其他下载管理器和加速器不同，Internet下载管理器在下载过程中动态下载文件，并重复使用可用的连接，无需额外的连接和登录阶段，以实现最佳的加速性能。
Internet Download Manager支持代理服务器，ftp和http协议，防火墙，重定向，Cookie，授权，MP3音频和MPEG视频内容处理。IDM可以无缝集成到Microsoft Internet Explorer，Netscape，MSN Explorer，AOL，Opera，Mozilla，Mozilla Firefox，Mozilla Firebird，Avant Browser，MyIE2等所有流行的浏览器中，以自动处理您的下载。您还可以拖放文件，或从命令行使用Internet Download Manager。互联网下载管理器可以在设定的时间拨打您的调制解调器，下载所需的文件，然后在完成后挂断电脑甚至关闭计算机。

### 2. IDM 批量导入助手
这是个绿色小工具，主要用来批量导入下载地址找到 IDM 中,还有就是可以通过它对下载地址重命名。

## 二、具体步骤
### 1. 登入慕课网 -> 下载课程地址页面 -> 打开控制台 -> 把下面的一段脚本复制贴到 `console` 运行
```js
(function () {
    document.cmd = '';
    var dic = {};
    function getJsonCallback(json) {
        var result = json.data.result;
        var data = { name: result.name, id: result.mid, url: result.mpath[0] };
        //替换文件名中的空格为 '-'，避免后面的 idm 批量导入工具文件名截取空格前半部分
        var name = data.name.replace(/ /g,'-'); 
        var cmd = 'filename=' + dic[data.id] + '-' + name + '&fileurl=' + data.url;
        console.log(cmd);
        document.cmd += cmd + '\r\n';
    }

    var index = 1;
    $('.J-media-item').each(function () {
        var url = $(this).attr('href');
        var data = url.split('/');
        var type = data[1];
        var id = data[2];
        if(type != 'video'){
            return;
        }
        var jsonPath = "http://www.imooc.com/course/ajaxmediainfo/?mid=" + id + "&mode=flash";
        dic[id] = index;
        $.getJSON(jsonPath, getJsonCallback);
        index++;
    });
})();
```

![IDM-20170530173651](https://raw.githubusercontent.com/Jesse-Chiu/images/master/IDM-20170530173651.png)

### 2. 运行结束 -> `document.cmd` -> 拷贝打印出的内容到文本文件 -> 文件后缀为 `imooc.downlist` ;
注意这里的文件编码需要保存为 ANSI 格式，不然下载的文件名中有中文的话，会出现乱码。

![IDM-20170530173900](https://raw.githubusercontent.com/Jesse-Chiu/images/master/IDM-20170530173900.png)

### 3. 运行[IDM批量导入助手](http://dl.pconline.com.cn/download/496539-1.html)
>注意下载该文件后需要放到 IDM 安装目录下
选择上一步保存的 `imooc.downlist` 文件,这样文件就会自动加入到 IDM 下载列表中，自动开始下载
> 可以输入下载文件格式后缀名 和 下载保存目录

**注意，如果有安装 360，该工具会被检测包含有病毒，如果怕死，那就 pass 吧!!!**

![IDM-20170530173900](https://raw.githubusercontent.com/Jesse-Chiu/images/master/IDM-20170530171718.png)

> 导入到 IDM 中下载，地址无误，如果提示错误，可能是下载地址的 `auth_key` 过期，重复上面的 1、2 两步，再试下。


## 参考

- [慕课网视频下载地址生成脚本(Javascript)](https://www.v2ex.com/t/226681)
- [使用js脚本批量下载慕课网视频](http://www.cnblogs.com/xiaoafei1991/p/5092853.html)
- [IDM批量导入助手 1.0.5.3 绿色版](http://dl.pconline.com.cn/download/496539-1.html)
- [IDM 绿色下载工具](http://www.zdfans.com/575.html)
- [IDM 官网](http://www.internetdownloadmanager.com/)
- [IDM(6.2.7破解中文)+批量导入工具](https://raw.githubusercontent.com/Jesse-Chiu/images/master/IDM%286.2.7%E7%A0%B4%E8%A7%A3%E4%B8%AD%E6%96%87%29.rar)



