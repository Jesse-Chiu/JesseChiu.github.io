---
title: Node.js 学习札记
date: 2017-08-24 10:24:54
updated: 2017-08-24 10:24:54
categories: Node.js
---

## 服务器配置 CSP 安全策略
```js
if (config.CSP_HEADER) {
  res.set({
    'Content-Security-Policy': config.CSP_HEADER,
    'X-Content-Security-Policy': config.CSP_HEADER,
    'X-WebKit-CSP': config.CSP_HEADER
  });
 }
```

## 解析 Ajax 提交的 Json 数据
前端代码
```js
let sendData = {
  date: 1501738051000,
  marks: ["writing","drawing"]
};
$.ajax({
  url:'http://a.test.com:3000/add-mark',
  method:'POST',
  data: JSON.stringify(sendData), // 转换为 json 格式
  contentType: "application/json; charset=utf-8", // 设置提交的数据类型
});
```
node.js 端代码
```js
// ...
// bodyParser 中间件解析 json 格式
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: false }));
// ...
router.post('/add-mark',(req,res,next)=>{
	console.log(`add-mark: ${JSON.stringify(req.body)} type:${typeof req.body}`);
	// ...
});
// add-mark: {"date":1501738051000,"marks":["writing","drawing"]} type:object
```

## 参考

- [参考](http://segmentfault.com/a/1190000000627041)