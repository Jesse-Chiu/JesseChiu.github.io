---
title: Ajax 详解(二)
date: 2016-10-16 22:13:29
updated: 2016-10-16 22:13:29
tags:
categories: Ajax
feature:
---

### 一、XMLHttpRequest

XMLHttpRequest 是一个 JavaScript 对象，它最初由微软设计,随后被 Mozilla、Apple 和 Google 采纳. 如今,该对象已经被 W3C 组织标准化. 通过它,你可以很容易的取回一个 URL 上的资源数据. 尽管名字里 有XML, 但 XMLHttpRequest 可以取回所有类型的数据资源，并不局限于 XML。 而且除了 HTTP ,它还支持 `file` 和 `ftp` 协议.

创建一个 XMLHttpRequest 实例, 可以使用如下语句:

`var req = new XMLHttpRequest();`

查看文章 [Using XMLHttpRequest](https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest) 来获取更多详细的 XMLHttpRequest 用法。

### 二、方法概述
```javascript

void abort();

DOMString getAllResponseHeaders();

DOMString? getResponseHeader(DOMString header);

void open(DOMString method, DOMString url, optional boolean async, optional DOMString? user, optional DOMString? password);

void overrideMimeType(DOMString mime);

void send();
void send(ArrayBuffer data);
void send(Blob data);
void send(Document data);
void send(DOMString? data);
void send(FormData data);

void setRequestHeader(DOMString header, DOMString value);
```

非标准方法

```javascript
[noscript] void init(in nsIPrincipal principal, in nsIScriptContext scriptContext, in nsPIDOMWindow ownerWindow);
[noscript] void openRequest(in AUTF8String method, in AUTF8String url, in boolean async, in AString user, in AString password);
void sendAsBinary(in DOMString body);
```

```javascript
getAllResponseHeaders()

DOMString getAllResponseHeaders();
返回所有响应头信息(响应头名和值), 如果响应头还没接受,则返回null. 注意: For multipart requests, this returns the headers from the current part of the request, not from the original channel.

getResponseHeader()

DOMString? getResponseHeader(DOMString header);
返回指定的响应头的值, 如果响应头还没被接受,或该响应头不存在,则返回null.

open()

初始化一个请求. 该方法用于 JavaScript 代码中;如果是本地代码, 使用 openRequest()方法代替.

注意: Calling this method an already active request (one for which open()or openRequest()has already been called) is the equivalent of calling abort().
void open(
   DOMString method,
   DOMString url,
   optional boolean async,
   optional DOMString user,
   optional DOMString password
);
```

### 三、参数

method
请求所使用的 HTTP 方法; 例如 "GET", "POST", "PUT", "DELETE"等. 如果下个参数是非 HTTP(S) 的 URL,则忽略该参数.

url

该请求所要访问的 URL

async

一个可选的布尔值参数，默认为 true,意味着是否执行异步操作，如果值为 false,则 send()方法不会返回任何东西，直到接受到了服务器的返回数据。如果为值为 true，一个对开发者透明的通知会发送到相关的事件监听者。这个值必须是 true,如果 multipart 属性是 true，否则将会出现一个意外。

user
用户名,可选参数,为授权使用;默认参数为空 string.

password

密码,可选参数,为授权使用;默认参数为空 string.

overrideMimeType()

重写由服务器返回的 MIME type。这个可用于, 例如，强制把一个响应流当作 “text/xml” 来处理和解析,即使服务器没有指明数据是这个类型。注意，这个方法必须在 send() 之前被调用。

void overrideMimeType(DOMString mimetype);

send()

发送请求. 如果该请求是异步模式(默认),该方法会立刻返回. 相反,如果请求是同步模式,则直到请求的响应完全接受以后,该方法才会返回.

**注意: 所有相关的事件绑定必须在调用 send() 方法之前进行.**

void send();
void send(ArrayBuffer data);
void send(Blob data);
void send(Document data);
void send(DOMString? data);
void send(FormData data);

setRequestHeader()

给指定的 HTTP 请求头赋值.在这之前,你必须确认已经调用 open() 方法打开了一个url.

void setRequestHeader(
   DOMString header,
   DOMString value
);

参数

header
将要被赋值的请求头名称.

value
给指定的请求头赋的值.
非标准方法


### 参考
- [XMLHttpRequest](https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest)