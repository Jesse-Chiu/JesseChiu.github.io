---
title: Vue 组件
date: 2016-11-25 17:33:43
updated: 2016-11-25 17:33:43
tags:
categories: Vue.js
feature:
---

## 一、概要
本文主要是针对 Vue.js 官网教程 **[组件](https://vuefe.cn/v2/guide/components.html)** 章节写的测试代码.

## 二、测试代码
1. 第一部分
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vue</title>
    <script type="text/javascript" src="bower_components/vue/dist/vue.js"></script>
</head>
<body>
<h1 ">Component</h1>
<div id="app">
	<h1>使用组件</h1>
	<label for="test">parentMsg: </label> <input type="text" id="test" v-model="parentMsg"> <br>
	<hr>
	1. 全局注册:
	<global-count my-Name='Jesse'></global-count>	
	<global-count my-Name='kuku'></global-count>	
	<hr>

	2. 局部注册
	<local-count name="lili"></local-count>
	<!-- 动态 props 测试代码 -->
	<!-- <local-count v-bind:name="parentMsg"></local-count> -->
	<hr>

	3. DOM 模板解析
	<ul>
		<dom-tem></dom-tem>
	</ul>

	4. data 必须是函数
	<ul>
 		<!-- 在第一个例子中把 data 替换为 sameCount 测试效果 -->
		<li>每次返回的都是新的对象</li>  
	</ul>

	5. 组件构成
	<ul>
		<li>组件 A 在它的模版中使用了组件 B</li>
		<li>父组件要给子组件传递数据</li>
		<li>子组件需要将它内部发生的<b>事情</b>告知给父组件</li>
		<li>父子组件解耦是很重要</li>
		<li><b>props down, events up</b></li>
	</ul>

	6. 使用 props 传递数据
	<ul>
		<li>组件实例的作用域是孤立的</li>
		<li><b>不能</b>并且<b>不应该</b>在子组件的模板内直接引用父组件的数据</li>
	</ul>

	7. 动态 props
	<ul>
		<li>用 v-bind 绑定动态 props 到父组件的数据</li>
	</ul>

	8. prop 验证
	<ul>
		<li><validate-temp>默认值:</validate-temp></li>
		<li><validate-temp age="18">字符串:</validate-temp></li>
		<li><validate-temp :age="28">数值:</validate-temp></li>
	</ul>
</div>
<script type="text/javascript ">
// var sameCount = {count:0}; 
Vue.component('globalCount',{
	// 注意这里的 html 代码，需要一个根元素(div)
	template:'<div><h2>{{myName}} {{count}}</h2><button v-on:click="count +=1 ">GlobalCount</button></div>',
	// 父组件可以通过 myName 传递数据
	props:['myName'],
	data:function(){
			return {count:0};
			// return sameCount;
		}
});
var localTemplate = {
	template: '<div><h2>{{name}} {{count}}</h2><button v-on:click="count +=1 ">LocalCount</button></div>',
	props:['name'],
	data:function(){
		return {count:0};
	}
};
// prop 验证
var validateTemp = {
	template:'<div><slot>My age: </slot> {{age}}  </div>',
	props:{
		 // 只检测类型
    	height: Number,
		// 检测类型 + 其他验证
	    age: {
	      type: Number, // 值类型
	      default: 0, // 默认值
	      required: true, // 必须有值
	      validator: function (value) {
	        return value >= 50
	      }
	    }
	}
};
var domTemplate = {
	template:'<table>xxxxx</table>'
};
var vm =  new Vue({
	el: '#app',
	components:{
		'localCount': localTemplate,
		'domTem':domTemplate,
		'validateTemp': validateTemp
	},
	data:{
		parentMsg:''
	}
});
</script>
</body>
</html>
```

2. 第二部分
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vue</title>
    <script type="text/javascript" src="bower_components/vue/dist/vue.js"></script>
</head>
<body>
<h1 ">Vue Component</h1>
<div id="app">
	<h1>自定义事件</h1>
	1. 使用 v-on 绑定自定义事件
	<ul>
		<li>使用 $on(eventName) 监听事件</li>
		<li>使用 $emit(eventName) 触发事件</li>
		<li>给组件绑定原生事件 v-on:click.native</li>
	</ul>
	<div>
		<p>计算总值: {{ total }}</p>
		<!-- 父组件通过 v-on 绑定子组件传来的事件，increment 是事件名称 -->
		$emit(eventName) 触发事件: 
		<button-counter v-on:increment="incrementTotal "></button-counter>
		<button-counter v-on:increment="incrementTotal "></button-counter> <br>
		绑定原生事件方法:
		<button-counter v-on:click.native="incrementTotal "></button-counter>
	</div>
	<hr>

	2. 使用自定义事件的表单输入
	<div>
		<p>Hello {{ message }}</p>
		<my-input label="Message" v-model="message"></my-input>
	</div>
	<hr>

	<h2>父子组件通信</h2>
	1. 使用 slot 分发内容
	<div>
	  <h1>I'm the parent title</h1>
	  <single-slot>
	    <p>This is some original content</p>
	  </single-slot>
	</div>
	<hr>

	2. 具名 slot
	<name-slot ref="nameSlot">
	  <b slot="header">title</b>
	  <b>title</b>
	  <b>content</b>
	  <b>content</b>
	  <b slot="footer">phone number</b>
	</name-slot>
	<hr>

	3. 动态组件
	<button v-on:click="changeView">changeView</button> 
	<keep-alive>
		<component v-bind:is="currentView">
	  		<!-- 组件在 vm.currentview 变化时改变！ -->
		</component>
	</keep-alive>
  <hr>

  4. 子组件索引
  <button @click="showChildComment">ShowChildComment</button> <br>
  <hr>

  5. 异步组件 <br>
  我要延时 2S 出现: <async-example></async-example>
  <hr>
</div>

<!-- ++++++++++++++++++++++template++++++++++++++++++++++++++ -->
<script type="x-template" id="test-1">
	'<button v-on:click="increment ">{{ counter }}</button>'
</script>

<script type="x-template" id="test-2">
	'<div><label v-bind:for="randomId">{{ label }}:</label><input v-bind:id="randomId" v-bind:value="value" v-on:input="onInput"></div>'
</script>

<script type="x-template" id="test-3">
`<div>
  <h2>I'm the child title</h2>
  <slot>
    如果没有分发内容则显示我。
  </slot>
</div>`
</script>

<script type="x-template" id="test-4">
`<div>
   header: <slot name="header"></slot> <br>
   default: <slot></slot> <br>
   footer: <slot name="footer"></slot> <br>
</div>`
</script>

<script type="text/javascript ">
// 使用 v-on 绑定自定义事件
Vue.component('button-counter', {
  // template: '<button v-on:click="increment ">{{ counter }}</button>',
  template: '#test-1',
  data: function () {
    return {
      counter: 0
    }
  },
  methods: {
    increment: function () {
      console.log('increment');
      this.counter += 1;
      // 通知父组件 'increment' 事件
      this.$emit('increment');
    }
  },
});

// 2. 使用自定义事件的表单输入
Vue.component('my-input', {
  template: '#test-2',
  props: ['value', 'label'],
  data: function () {
    return {
      randomId: 'input-' + Math.random()
    }
  },
  methods: {
    onInput: function (event) {
      this.$emit('input', event.target.value)
    }
  },
});

// 单 slot
Vue.component('single-slot',{
	template:'#test-3'
});
// 具名 slot
Vue.component('name-slot',{
	template:'#test-4'
});

// 异步组件
Vue.component('async-example', function (resolve, reject) {
  setTimeout(function () {
    resolve({
      template: '<div>I am async!</div>'
    })
  }, 2000)
})
//--------------------------------------------
new Vue({
  el: '#app',
  data: {
    total: 0,
    message:'man',
    viewState:0,
    viewArray:['home','posts','archive'],
    currentView: 'home' // 默认指定 home 模板
  },
  methods: {
    incrementTotal: function () {
      console.log('incrementTotal');
      this.total += 1
    },
  changeView:function(){
  		this.viewState++
  		if(this.viewState === 3){
			this.viewState = 0;
  		}
  		this.currentView = this.viewArray[this.viewState];
  	},
    showChildComment:function(){
      console.log('showChildComment: ',this.$refs.nameSlot);
    }
  },
  components:{
  	home: {template:'<div>home</div>'},
    posts: {template:'<div>posts</div>'},
    archive: {template:'<div>archive</div>'}
  }
});
</script>
</body>
</html>

```